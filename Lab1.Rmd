---
title: "Lab 1: Exploratory Analysis of CEO Salary Data"
author: "Carmen Easterwood & Andrew Kabatznick"
date: "January 29, 2016"
output:
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

Aaa

```{r}
setwd("~/Desktop/MIDS/Statistics/stats_lab1")
ceosal <- load("ceo_w203.RData", ceo.env <- new.env())
ceo.df <- ceo.env[["CEO"]]
```

# Univariate Analysis of Key Variables

In the following section we will perform a univariate analysis of each of the variables in this dataset. Salary is our outcome variable, and profits and mktval are the key measures of market performance.

### Salary

CEO salary distribution is strongly skewed right.

```{r}
hist(ceo.df$salary, main = "Histogram of CEO Salary in 1990",
     xlab = "Salary in $ thousands", breaks = seq(0, 6000, by = 500))
axis(1, at = seq(0, 6000, by = 1000))
```

Median salary is $`r median(ceo.df$salary)` thousand, and there is one extreme outlier at $`r round(max(ceo.df$salary) / 1000, 1)` million.

```{r}
summary(ceo.df$salary)
```

### Age

CEO age peaks between 50 and 65 years old, but ranges all the way from `r min(ceo.df$age)` to `r max(ceo.df$age)`.
```{r}
hist(ceo.df$age, breaks = 14, main = "Histogram of CEO Age", xlab = "Age")
summary(ceo.df$age)
```

The variance of Age is large:
```{r}
var(ceo.df$age)
```

### College Degree

College is a dummy variable that takes a value of 1 if the CEO is a college graduate and 0 otherwise.

```{r}
pct.college <- (sum(ceo.df$college) / length(ceo.df$college))
```

`r round(pct.college * 100, 1)`% of the CEOs in this dataset are college graduates.

### Graduate Degree

Grad is a dummy variable that takes a value of 1 if the CEO holds an advanced degree and 0 otherwise.

```{r}
pct.grad <- (sum(ceo.df$grad) / length(ceo.df$grad))
```

`r round(pct.grad * 100, 1)`% of the CEOs in this dataset are college graduates.

```{r, include = FALSE}
sub <- subset(ceo.df, ceo.df$college == 0 & ceo.df$grad == 1)
```

**Note: Should we mention there are `r length(sub$salary)` CEOs with an advanced degree but no college degree? (Can that be correct?)**

### Years With Company
The Median (`r round(median(ceo.df$comten), 1)`) and Mean (`r round(mean(ceo.df$comten), 1)`) both indicate that in general CEOs have been with their companies around 21 years. However, the data is highly variable with a min of `r round(min(ceo.df$comten), 1)` and a max of `r round(max(ceo.df$comten), 1)`.
```{r}
summary(ceo.df$comten)
```

Variance of Years with Company
```{r}
var(ceo.df$comten)
```

The standard deviation for years with the company is ~`r round(sd(ceo.df$comten), 1)`, which is large but unsurprising given the variablity of the dataset.
```{r}
sd(ceo.df$comten)
```

Histogram of Years with Company
```{r}
hist(ceo.df$comten,main="Years with Company",xlab = "Years")
```

### Years as CEO
The years as CEO variable exhibits a large right skew with a median of around `r round(median(ceo.df$comten), 1)`. This is not entirely suprising given CEOs tend to be established in their careers and thus older, which may explain while things tail off. We must also wonder if there is a large turnover in the first few years of a CEOs tenure as most CEOs are between 0-5 years in the position.

Summary Statistics for Years as CEO
```{r}
summary(ceo.df$ceoten)
```

Variance of Years as CEO
```{r}
var(ceo.df$ceoten)
```

Standard Deviation of Years as CEO
```{r}
sd(ceo.df$ceoten)
```

Histogram of Years as CEO
```{r}
hist(ceo.df$ceoten,main="Years as CEO",xlab = "Years",breaks=20)
```

### Profits
Companies in the sample tend to make a profit as shown by the median profit of `r round(mean(ceo.df$comten), 1)`. The mean is significanlty higher than the median driven by a notable outlier of `r round(max(ceo.df$comten), 1)`

Summary Statistics for Profits
```{r}
summary(ceo.df$profits)
```

Variance of Profits
```{r}
var(ceo.df$profits)
```

Standard Deviation of Profits
```{r}
sd(ceo.df$profits)
```

Histogram of Profits
```{r}
hist(ceo.df$profits,main="1990 Profits",xlab = "millions",breaks = 100)
```

### Market Value
Unsurprisingly, the Market Value for companies has a right skew. The Min `r round(min(ceo.df$mktval), 1)` looks to be in error as Market Values should range from 0 to infinity.

Summary Statistics for Market Value
```{r}
summary(ceo.df$mktval)
```

Variance of Market Value
```{r}
var(ceo.df$mktval)
```

Standard Deviation of Market Value
```{r}
sd(ceo.df$mktval)
```

Histogram of Market Value
```{r}
hist(ceo.df$mktval, main="Market Value at the End of 1990",
     xlab = "millions", breaks = 100)
```


# Key Bivariate Relationships
We will now analyze some key bivariate relationships. Below is a scatterplot matrix of the variables in this dataset.

```{r}
library(car)
scatterplotMatrix(ceo.df)
```

### Profits & Market Value

These are our two measures of company performance, so we confirm they are positively correlated.
```{r}
cor(ceo.df$profits, ceo.df$mktval)
```

For the most part, as profits increase, so does market value.

```{r}
plot(ceo.df$profits, ceo.df$mktval,
     main = "Profits vs. Market Value in 1990",
     xlab = "Market Value ($ millions)",
     ylab = "Profits ($ millions)")
abline(lm(ceo.df$mktval ~ ceo.df$profits), col = "red")
```

# Possible Secondary Variables

Aaa
```{r}
```

# Potential Confounding Effects

Aaa
```{r}
```


# Variable Coding Issues and Missing Values

Aaa
```{r}
```

# Conclusion

Aaa
```{r}
```
